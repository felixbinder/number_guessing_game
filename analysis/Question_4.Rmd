---
title: "Question 4"
author: "Crystal Poole, Felix Binder, Cameron Jones, Naomi Lin"
date: "11/30/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

##############################################################################################

```{r}
# --- Setup --- #

# Load libraries
library(tidyverse)
library(RColorBrewer)
library(knitr)

# Load data
games <- read.csv("../data/games.csv")
view(games)

guesses <- read.csv("../data/guesses.csv")
view(guesses)

higher_lower <- read.csv("../data/higher-lower-data2.csv")
view(higher_lower)

repeat_player_prediction <- read.csv("../data/repeat-player-prediction.csv")
view(repeat_player_prediction)

# Cast startTime and endTime to POSIX
games <- games %>%
  mutate(
    startTime = as.POSIXct(startTime),
    endTime = as.POSIXct(startTime)
  )

# Create color palette
paired <- brewer.pal(6, "Paired")
color1 <- paired[1]
color2 <- paired[2]
color3 <- paired[3]

```
### Question 4: Does playersâ€™ success affect their likelihood to continue playing? (Crystal)
##### Definitions of success: whether they finished the game, but unfinished games are excluded from dataset. Number of guesses above average? above 75th percentile?
####Are better or worse players more likely to continue playing?

#####For first game:
```{r}
repeat_player_prediction$num_guesses <- as.factor(repeat_player_prediction$num_guesses)
ggplot(data=repeat_player_prediction, mapping = aes( x= num_guesses))+geom_bar(fill= color1)

percentile_guesses <- quantile(as.numeric(repeat_player_prediction$num_guesses_quantile))
repeat_player_prediction <- repeat_player_prediction %>% mutate(num_guesses_quantile = case_when (
  as.numeric(num_guesses) < 7 ~ "Below 50th",
  as.numeric(num_guesses) == 7 ~ "50th Percentile",
  as.numeric(num_guesses) > 7 ~ "Above 50th"))
view(repeat_player_prediction)

ggplot(data=repeat_player_prediction, mapping = aes( x= num_guesses_quantile, y= willReturn))+
  geom_jitter(fill= color1) #Looking at the quantiles of number of guesses based on whether they return or not (this is a terrible graph-- need to just check quantitatively)

ggplot(data=guesses, mapping = aes( x= as.factor(outOfBounds)))+geom_bar(fill= color1) #Checking how many guesses are out of bounds as a potential indicator of bad players.
```

####Using binary search is probably not a very interesting use of time?
####Do some players learn about binary search through playing the game and then stop once they understand it is optimal
